<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
  </head>
  <body>
    <h1><%= title %></h1>
    <p>Welcome to <%= title %></p>

    <div class='dlogin'>
      <form class='login'>
      Email<input type="text" name='email' value='ddmail2009@gmail.com'>
      Password<input type="password" name='password' value='default'>
      <button id='login'>Submit</button>
      </form>
    </div>

    <div class='dlogout'>
      <form class='logout'>
      <button id='logout'>logout</button>
      </form>
    </div>

    <div class='dstatus'>
      <form class='getlist'>
      <button>getstatus</button>
      </form>
      <div class='status'></div>
    </div>

    <div class='dmodify'>
      <form class='modify'>
        input data you want to modified in JSON format<br/>
        ex. {"language":["english", "chinese", 2]}
        <input type='text' name='modify' id='modify_item' value='{"language":["english", "chinese", 2]}'>
        <button>modify</button>
      </form>
    </div>

    <script>
      var token = null;
      var id = null;

      $('.modify').submit(function(){
        try{
          var data = JSON.parse($('#modify_item').val());
          data['token'] = token;
          console.log(data);
          $.post('./'+id+'/modify', data, function(message){
            console.log(message);
          }, 'text')
        }
        catch(err){
          console.log(err);
          console.log('can"t understand midify item')
        }
        return false;
      })

      $('.getlist').submit(function(){
        $.post("./"+id+'/status', {token: token}, function(data){
          console.log(data);
          $('.status').html(data);
        }, 'text');
        return false;
      })

      $('.login').submit(function(){
        var data = {email:$("input[name=email]").val(), password:$('input[name="password"]').val()};
        $.post("./login", data, function(data){
          token = JSON.parse(data).token;
          id = JSON.parse(data).id;
          console.log(data);
        }, "text");
        return false;
      });

      $('.logout').submit(function(){
        $.post('./logout', {token: token}, function(data){
          console.log(data);
        }, 'text')
        return false;
      });

    </script>
  </body>
</html>